C51 COMPILER V9.53.0.0   I2C_PROG                                                          11/19/2024 15:08:59 PAGE 1   


C51 COMPILER V9.53.0.0, COMPILATION OF MODULE I2C_PROG
OBJECT MODULE PLACED IN .\Code\Obj\I2C_prog.obj
COMPILER INVOKED BY: D:\USR\Keil_v5\C51\BIN\C51.EXE Code\Source\I2C_prog.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\Lib_nuvoton
                    -;.\Common;.\Code\Head;.\Code\Source;.\Code\Obj;.\LST;.\Output) DEFINE(FOSC_160000) DEBUG OBJECTEXTEND PRINT(.\LST\I2C_pr
                    -og.lst) TABS(2) OBJECT(.\Code\Obj\I2C_prog.obj)

line level    source

   1          //**************************************************************************
   2          //  I2C_prog
   3          //**************************************************************************
   4          
   5          #include <I2C_prog.h>
*** ERROR C168 IN LINE 32 OF .\Code\Head\I2C_prog.h: 'bufferTxPacket': array of bit
*** ERROR C141 IN LINE 53 OF .\Code\Head\I2C_prog.h: syntax error near 'void'
*** ERROR C141 IN LINE 53 OF .\Code\Head\I2C_prog.h: syntax error near 'mode', expected ')'
   6          
   7          bit FlagI2cStart  = 0;
   8          bit FlagI2cDelay  = 0;
   9          
  10          xdata int I2cSizebuf  = I2C_SIZE_PACKET_BUF;
  11          xdata int sizeADR     = I2C_SIZE_ADR;
  12          xdata int sizeData    = I2C_SIZE_DATA;
  13          
  14          void I2C_change_size_ADR  (int value){sizeADR = value;}
  15          void I2C_change_size_DATA (int value){sizeData= value;}
  16          
  17          //********************************************************
  18          //      _____      _____        ->  CLK
  19          //      |   |      |   |
  20          //______|   |______|   |______
  21          //  f()  f()  f()   f()  f()    ->  I2C_exchange_start()
  22          //********************************************************
  23          /* main func(for timer) */
  24          void I2C_exchange_start(){
  25   1        /*every clk launch*/
  26   1        // то что использовать в таймере и чо выставл€ть в момент времени
  27   1        
  28   1        
  29   1      }
  30          
  31          
  32          void I2C_exchange_do(I2cMode mode){
  33   1        // здесь мне надо задать cигнал clk 
  34   1        // пройти мимо
  35   1        // когда вернусь прочитать
  36   1        // записать новое значение и пройти мимо ( вернутс€ в начало)
  37   1        
  38   1        if( counterBit || I2C_CPOL){
  39   2          
  40   2        }
  41   1        
  42   1        if( I2C_SLK == I2C_CPHA ){
  43   2          switch(counterBit){             //  start exchange  
  44   3      /*End bit packet  */
  45   3            case I2cSizeBuf:  /*  max bit */
  46   3              /*need next byte?*/
  47   3              if(counterByte > sizeByteForDend){+
  48   4                FlagI2cStart  = 0;
  49   4                I2C_SLK       = 0;
  50   4                I2C_SDA       = 0;
C51 COMPILER V9.53.0.0   I2C_PROG                                                          11/19/2024 15:08:59 PAGE 2   

  51   4              }
  52   3              else{
  53   4                counterByte++;            // next byte
  54   4              }
  55   3              break;
  56   3      /* process going  */
  57   3            default:  /* 0 -> max bit - 1*/
  58   3              switch(mode){
  59   4                case SEND:
  60   4                  //складывать в буфер I2C_SDA
  61   4                  break;
  62   4                case READ:
  63   4                
  64   4                if(I2C_SDA == 1){
  65   5                  //прочитать
  66   5                  }
  67   4                  break;
  68   4                default:break;
  69   4              }
  70   3            
  71   3              I2C_SDA = output;
  72   3      /* next bit   */
  73   3              counterBit++;     
  74   3              break;
  75   3          }
  76   2          
  77   2        }
  78   1      
  79   1      }
  80          
  81          void I2C_exchange_end(){
  82   1        //  все линии в 0 или в 1
  83   1        // мб добавить сюда настройки
  84   1      
  85   1      }
  86          
  87          void I2C_delay(){
  88   1        // верм€€ задержки
  89   1        // например ширина импульса и следовательно скорость обмена
  90   1      
  91   1      }
  92          
  93          void I2C_init_CLK(bit value){
  94   1        I2C_SLK = value;
  95   1      }
  96          
  97          static bit I2C_Get_Buf_TX(){
  98   1        return 1;
  99   1      }
 100          
 101          static bit I2C_Get_Buf_RX(){
 102   1        return 1;
 103   1      }
 104          
 105          

C51 COMPILATION COMPLETE.  0 WARNING(S),  3 ERROR(S)
